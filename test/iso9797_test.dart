import 'package:iso9797/iso9797.dart';
import 'package:test/test.dart';

void main() {
  final key = [
    0x46,
    0xB0,
    0xAA,
    0x84,
    0xC9,
    0xAB,
    0x2C,
    0xC8,
    0x7F,
    0xBD,
    0x7C,
    0x73,
    0x6E,
    0x51,
    0x5C,
    0x06,
  ];

  final message = [
    0x01,
    0x00,
    0x60,
    0x38,
    0x05,
    0x80,
    0x20,
    0xC1,
    0x90,
    0x01,
    0x16,
    0x62,
    0x74,
    0x12,
    0x11,
    0x95,
    0x11,
    0x98,
    0x54,
    0x31,
    0x00,
    0x00,
    0x12,
    0x34,
    0x57,
    0x14,
    0x24,
    0x03,
    0x06,
    0x10,
    0x00,
    0x21,
    0x03,
    0x00,
    0x00,
    0x37,
    0x62,
    0x74,
    0x12,
    0x11,
    0x95,
    0x11,
    0x98,
    0x54,
    0xd2,
    0x81,
    0x01,
    0x00,
    0x52,
    0x63,
    0x95,
    0x94,
    0x34,
    0x04,
    0x80,
    0x30,
    0x01,
    0x14,
    0x32,
    0x30,
    0x00,
    0x00,
    0x00,
    0x50,
    0x99,
    0x40,
    0x00,
    0x25,
    0x11,
    0x01,
    0x4E,
    0x38,
    0x32,
    0x57,
    0x33,
    0x33,
    0x30,
    0x39,
    0x36,
    0x35,
    0x06,
    0x02,
    0x35,
    0x2E,
    0x30,
    0x2E,
    0x33,
    0x02,
    0x03,
    0x30,
    0x02,
    0x15,
    0x32,
    0x33,
    0x36,
    0x34,
    0xB5,
    0xB5,
    0x2E,
    0xB4,
    0x10,
    0x13,
    0x9F,
    0xD7
  ];

  test('Algorithm 1', () {
    //expect(calculate(), 42);
  });

  test('Algorithm 3', () {
    final mac = algorithm3Mac(key, message);

    final hex = mac.map((e) => e.toRadixString(16)).join().toUpperCase();
    expect(hex, '35353542344438');
  });
}
